<!-- Disclaimer for content box so people don't delete it -->
<p style="text-align: center;">&nbsp;</p>

<p id="css-admin-disclaimer" style="text-align: center;"><span style="color:#000000;">This element is only showing to admins in edit mode, please do not delete this block as it's fixing the functionality of the page using scripts. It's currently being maintained <a href="https://github.com/MachoPiggies/Undeb-UnionCloud-Clubs-Fix" target="_blank">here</a>!</span></p>

<!-- Below is the actual CSS edits -->
<style type="text/css">

/* Fixes an issue where on some mobile devices, screen overhang can occur and the black background of the site did not extend to it, causing a bright white line down the right of the page */
html {
  background-color: var(--body-fade-color);
}

/* Fixes an issue with the pink topbar where it doesn't extend Y-ways correctly on smaller screens */
.uc-mega-menu .uc-mega-menu-wrapper {
  height: 100%;
}

/* Relates to the above fix */
.uc-mega-menu .uc-mm-level-one.hover .uc-sub-mega-menu {
  top: 100%;
}
  
/* Removes a strange bar that would appear alongside the sidebar, but not extend the height of the whole page */
.content-wrap.ninecol>div {
  background: none;
}

/* Fixes an issue where the society/club categories would appear white on white background (invisible) in the sidebar, leaving a strange open space */
#uc-groups-details-page .group_left_panel_menu .typeCategory {
  color: #000;
  padding-top: 10px;
}

/* Modifies the type of bullets used automatically in the sidebar category system to be more consistent with the rest of the website */
#uc-groups-details-page .group_left_panel_menu .typeCategory li {
  list-style-type: disc;
}

/* Modifies the type of bullets used automatically in the sidebar category system to be black instead of white (white text on white background makes them invisible) */
#uc-groups-details-page .group_left_panel_menu .typeCategory li::marker {
  color: #000;
}

/* Fixes an issue where the join group button would sometimes hide behind the sidebar */
#uc-groups-details-page .join-this-group {
  display: block !important;
  width: 100%;
}

/* CSS-styling for the description box */
.tree-navigation .description {
  padding: 25px 10px 10px 35px;
}

/* Fixes an issue where page text on the white side panel defaulted to white (on white) */
.tree-navigation {
  color: #000;
}

/* Fixes an inconsistency where hyperlinks would have a different size and contain an underline if they were specifically placed in the white sidebar */
.tree-navigation a {
    font-size: unset;
    text-decoration: none;
}

/* Fixes an issue where page titles for pages added to the white sidebar would appear white (on white) and not correctly positioned - it's a bit of a janky fix but it works */
.tree-navigation .page-title {
  color: #000;
  padding: 0 10px 10px 20px;
  font-size: larger;
  font-weight: bold;
  top: 10px;
  position: relative;
}

/* Fixes an issue where the content of tabs would by default appear black (on black) & the text size would appear smaller than intended */
.content-wrap .tab .tab-content {
  color: #fff;
  font-size: 16px;
  line-height: 1em;
}

/* Fixes an issue where bullets in the content of tabs would appear black (on black) */
.content-wrap .tab .tab-content li::marker {
  color: #fff;
}

/* Fixes an issue where bullet or numbered lists would appear oddly in the content of tabs */
.content-wrap .tab .tab-content ul,
.content-wrap .tab .tab-content ol {
  margin-left: 0;
  padding-left: 1em;
  list-style-position: inside;
}

/* Fixes an issue where tab content automatic colour would overwrite URL colour */
.content-wrap .tab .tab-content a {
  color: var(--default-orange);
}

/* Locks the white sidebar to the max size of all pages within it to stop it moving and messing up some browsers */
.module_groups.action_show .threecol.tree-navigation {
  height: 100%;
  padding-bottom: 10px;
}

/* Automatically aligns text to left on slider text to make it more readable */
.uc-slider-wrapper .uc-slider-banner p {
  text-align: left;
}

/* Fixes an inconsistency with hyperlinks where they'd change colour when visited */
a, a:visited {
  color: var(--default-orange);
}

/* Styling for the mobile sidebar dropdown button */
.tree-navigation .title button {
  display: none;
  position: absolute;
  right: 30px;
  top: 15px;
  height: 30px;
  width: 30px;
}

/* Adds a dropdown hide class, if we just hide the display, making things reappear if the screen size changes would be more difficult than needed */
.tree-navigation .dropdown-hide {
  display: block;
}

@media only screen and (max-width: 767px) {
  /* Fixes an issue with the Tab type container where the active tab title background would disappear on certain smaller screens */
  .tab .ui-state-active, .tab .ui-widget-content .ui-state-active, .tab .ui-widget-header .ui-state-active {
    background: #384352;
  }

  /* Moves the white sidebar to the top middle of the page so mobile users can actually see the page */
  .module_groups.action_show #uc-groups-details-page {
    display: block;
  }

  /* Fixes issue where the white sidebar would sometimes appear off-centre depending on screen size */
  .threecol.left-nav-content.tree-navigation {
    margin: 10px auto 10px auto;
  }

  /* Centres the join button to look better on mobile */
  #uc-groups-details-page .join-this-group {
    text-align: center;
  }

  /* Cuts off unnecessary slider spacing for text on slider images */
  .uc-slider-banner-wrapper {
    margin: 0;
    padding: 0;
  }

  /* Reduces unnecessary slider spacing for text on slider images */
  .uc-slider-wrapper .uc-slider-banner p {
    padding: 5px;
  }

  /* Modifies the title element in the white sidebar to work with the dropdown */
  .tree-navigation .title {
    position: relative;
  }

  /* Shows the sidebar toggle button for mobile users */
  .tree-navigation .title button {
    display: block;
  }

  /* Hider for the sidebar toggle button */
  .tree-navigation .dropdown-hide {
    display: none;
  }

  /* Adds additional spacing to the top of the join button so it doesn't look like it's trying to escape up into the white midbar */
  .module_groups.action_show #uc-groups-details-page .join-this-group a {
    margin-top: 50px;
  }
}
</style>

<script>
  // Deletes the disclaimer for people not in edit mode
  if (!document.querySelector('.edit-page, .addsectionButton, .tool-bar.pagetoolbar')) document.getElementById("css-admin-disclaimer").remove();

  // Adds the description element back to the sidebar
  setTimeout(function() {
    const groupPanel = document.querySelector("#uc-groups-details-page .group_left_panel_menu");
    const portlet = document.querySelector("#uc-groups-details-page .portlet");
    if (groupPanel && !portlet) {
      const ogDescription = document.querySelector('meta[property="og:description"]');
      const content = ogDescription ? ogDescription.content : null;
      
      if (content) {
        const div = document.createElement("div");
        div.className = "description";
        div.textContent = content;
    
        const firstUl = groupPanel.querySelector("ul");
        groupPanel.insertBefore(div, firstUl);
      }
    }
  }, 1);

  // Stops the pink topbar options from showing a dropdown pane if there's nothing inside it, also fixes silly Undeb typos where they leave empty information in the dropdowns
  for (const pane of document.querySelectorAll(".uc-sub-mega-menu")) {
    for (const row of pane.querySelectorAll(".uc-mm-row")) {
      for (const column of row.querySelectorAll(".uc-mm-column")) {
        for (const ul of column.querySelectorAll("ul")) {
          for (const li of ul.querySelectorAll("li")) {
            if (li.innerHTML && li.innerHTML.trim().length > 0) continue;
            li.remove();
          }
          if (ul.children.length === 0) ul.remove();
        }
        if (column.children.length === 0) column.remove();
      }
      if (row.children.length === 0) row.remove();
    }
  
    if (pane.children.length === 0) {
      pane.remove();
      continue;
    }
  }

  // Functionality for the white sidebar dropdown
  const title = document.querySelector(".group_left_panel_menu .title");
  if (title) {
  const btn = document.createElement("button");
  btn.class = "mobile-toggle-btn";
  btn.textContent = "▼";
  btn.onclick = () => {
    if (btn.textContent === "▼") {
      const panel = document.querySelector(".group_left_panel_menu") || {children: []};
      for (const q of panel.children) {
        if (q.classList.contains("title")) continue;
        q.classList.add("dropdown-hide");
      }
      
      const sections = document.querySelector(".threecol.left-nav-content.tree-navigation .section.list");
      if (sections) sections.classList.add("dropdown-hide");
      btn.textContent = "▲";
    } else {
      const panel = document.querySelector(".group_left_panel_menu") || {children: []};
      for (const q of panel.children) {
        if (q.classList.contains("title")) continue;
        q.classList.remove("dropdown-hide");
      }
      
      const sections = document.querySelector(".threecol.left-nav-content.tree-navigation .section.list");
      if (sections) sections.classList.remove("dropdown-hide");
      btn.textContent = "▼";
    }
  };

  title.appendChild(btn);
}

  // Point of contact if the SU or UnionCloud go after anyone using this script
  console.log("The script used to fix various issues with the clubs pages has been created by Daniel (500644299), you can see it here https://github.com/MachoPiggies/Undeb-UnionCloud-Clubs-Fix");
</script>
